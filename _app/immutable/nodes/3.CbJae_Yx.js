import{a as o,f as n}from"../chunks/P9lsyJN8.js";import{o as me}from"../chunks/BDunwwt_.js";import{Y as ge,Z as A,_ as xe,a1 as he,a5 as i,a3 as r,f as e,a6 as t,a0 as u,a8 as K,a2 as l,a4 as Q,a9 as be,a7 as we}from"../chunks/DsCzRQW9.js";import{d as ke,s as m}from"../chunks/C-_o5PLK.js";import{i as C}from"../chunks/rK5mkmgS.js";import{e as Ee,i as je}from"../chunks/BYJ2rnKm.js";import{s as Ae,r as Ce}from"../chunks/b05JO4El.js";import{g as Ge,s as $}from"../chunks/zUqiq0NJ.js";import{s as Me}from"../chunks/CeoFgO1r.js";import{b as Se}from"../chunks/CkB6V6u5.js";import{b as ee}from"../chunks/CAB4_IbL.js";import{g as Te}from"../chunks/B8PVRu2a.js";function qe(p){const P=p.goals.length>0?p.goals.map(g=>Be(g)).join(", "):"General",M=p.weakAreas.length>0?p.weakAreas.join(", "):"General English";return`Generate English exercises for a ${p.level} Spanish speaker.

Focus areas: ${M}

Requirements:
- Return ONLY valid JSON
- Be concise
- Make questions culturally relevant to ${P}

Exercise format:
{
  "exercises": [
    {
      "type": "multiple_choice|fill_blank|translation|error_correction",
      "question": "...",
      "options": ["...", "...", "...", "..."],
      "correctAnswer": "...",
      "explanation": "...",
      "weakArea": "..."
    }
  ]
}`}function Be(p){return{travel:"Travel",work:"Business English",study:"Academic",movies:"Media & Culture",general:"General"}[p]}var Le=n('<div class="error-message svelte-uy2dd0"><p class="svelte-uy2dd0"> </p> <a class="btn secondary svelte-uy2dd0">Ir a Configuración</a></div>'),Ne=n('<div class="empty-state svelte-uy2dd0"><div class="illustration svelte-uy2dd0"><svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg></div> <h3 class="svelte-uy2dd0">¿Listo para practicar?</h3> <p class="svelte-uy2dd0">Generaré ejercicios basados en tu nivel y áreas de mejora.</p> <button class="btn primary svelte-uy2dd0"> </button> <!></div>'),Oe=n("<button> </button>"),Pe=n('<div class="options svelte-uy2dd0"></div>'),Re=n('<input type="text" class="text-input svelte-uy2dd0" placeholder="Tu respuesta..."/>'),Ie=n('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg> <span>¡Correcto!</span>',1),Je=n('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg> <span> </span>',1),Ve=n('<div class="explanation svelte-uy2dd0"><strong>Explicación:</strong> </div>'),Ye=n('<div><!></div> <!> <button class="btn primary svelte-uy2dd0"> </button>',1),Fe=n('<button class="btn primary svelte-uy2dd0">Responder</button>'),He=n('<div class="exercise-card svelte-uy2dd0"><div class="exercise-type svelte-uy2dd0"> </div> <h2 class="question svelte-uy2dd0"> </h2> <!> <!></div>'),ze=n('<div class="completion svelte-uy2dd0"><h2 class="svelte-uy2dd0">¡Completado!</h2> <p class="svelte-uy2dd0">Has completado todos los ejercicios.</p> <button class="btn primary svelte-uy2dd0">Generar Más</button></div>'),Ue=n('<div class="progress-bar svelte-uy2dd0"><div class="progress-fill svelte-uy2dd0"></div></div> <div class="progress-text svelte-uy2dd0"> </div> <!>',1),Ze=n('<div class="exercises-page svelte-uy2dd0"><header class="header svelte-uy2dd0"><h1 class="svelte-uy2dd0">Ejercicios</h1> <p class="subtitle svelte-uy2dd0">Practica con ejercicios adaptados a tu nivel</p></header> <!></div>');function it(p,P){ge(P,!0);let M=Ge(),g=A(xe([])),R=A(!1),S=A(0),_=A(""),k=A(!1),G=A(!1),I=A("");me(()=>{if(!M){window.location.href=`${ee}/onboarding`;return}});async function te(){if(M){l(R,!0),l(I,"");try{const c=qe(M),v=(await Te([{role:"system",content:c},{role:"user",content:"Generate 3 exercises for me. Return ONLY valid JSON."}],{maxTokens:800,temperature:.8})).content.match(/\{[\s\S]*\}/);if(v){const T=JSON.parse(v[0]);l(g,T.exercises||[],!0)}}catch(c){console.error("Failed to generate exercises:",c),l(I,"Error de conexión. Ve a Configuración para elegir otra API o agregar tu propia clave.")}finally{l(R,!1)}}}function re(){if(!e(_))return;const c=e(g)[e(S)];l(G,e(_)===c.correctAnswer),l(k,!0)}function se(){be(S),l(_,""),l(k,!1),l(G,!1)}let y=Q(()=>e(g)[e(S)]),Y=Q(()=>e(S)+1),F=Q(()=>e(g).length);var H=Ze(),ae=i(r(H),2);{var oe=c=>{var E=Ne(),v=i(r(E),6);v.__click=te;var T=r(v,!0);t(v);var q=i(v,2);{var z=B=>{var L=Le(),N=r(L),x=r(N,!0);t(N);var f=i(N,2);t(L),u(()=>{m(x,e(I)),Ae(f,"href",`${ee}/settings`)}),o(B,L)};C(q,B=>{e(I)&&B(z)})}t(E),u(()=>{v.disabled=e(R),m(T,e(R)?"Generando...":"Generar Ejercicios")}),o(c,E)},ie=c=>{var E=Ue(),v=K(E),T=r(v);t(v);var q=i(v,2),z=r(q);t(q);var B=i(q,2);{var L=x=>{var f=He(),O=r(f),le=r(O,!0);t(O);var U=i(O,2),ne=r(U,!0);t(U);var W=i(U,2);{var ce=s=>{var a=Pe();Ee(a,21,()=>e(y).options,je,(h,b)=>{var j=Oe();let J;j.__click=()=>!e(k)&&l(_,e(b),!0);var Z=r(j,!0);t(j),u(()=>{J=$(j,1,"option-btn svelte-uy2dd0",null,J,{selected:e(_)===e(b),correct:e(k)&&e(b)===e(y).correctAnswer,incorrect:e(k)&&e(_)===e(b)&&!e(G)}),m(Z,e(b))}),o(h,j)}),t(a),o(s,a)},ve=s=>{var a=Re();Ce(a),u(()=>a.disabled=e(k)),Se(a,()=>e(_),h=>l(_,h)),o(s,a)};C(W,s=>{e(y).options?s(ce):s(ve,!1)})}var de=i(W,2);{var ue=s=>{var a=Ye(),h=K(a);let b;var j=r(h);{var J=d=>{var w=Ie();we(2),o(d,w)},Z=d=>{var w=Je(),V=i(K(w),2),fe=r(V);t(V),u(()=>m(fe,`Incorrecto. La respuesta correcta es: ${e(y).correctAnswer??""}`)),o(d,w)};C(j,d=>{e(G)?d(J):d(Z,!1)})}t(h);var X=i(h,2);{var _e=d=>{var w=Ve(),V=i(r(w));t(w),u(()=>m(V,` ${e(y).explanation??""}`)),o(d,w)};C(X,d=>{e(y).explanation&&d(_e)})}var D=i(X,2);D.__click=se;var ye=r(D,!0);t(D),u(()=>{b=$(h,1,"result svelte-uy2dd0",null,b,{correct:e(G),incorrect:!e(G)}),m(ye,e(Y)<e(F)?"Siguiente":"Terminar")}),o(s,a)},pe=s=>{var a=Fe();a.__click=re,u(()=>a.disabled=!e(_)),o(s,a)};C(de,s=>{e(k)?s(ue):s(pe,!1)})}t(f),u(s=>{m(le,s),m(ne,e(y).question)},[()=>e(y).type.replace("_"," ")]),o(x,f)},N=x=>{var f=ze(),O=i(r(f),4);O.__click=()=>{l(g,[],!0),l(S,0)},t(f),o(x,f)};C(B,x=>{e(y)?x(L):x(N,!1)})}u(()=>{Me(T,`width: ${e(Y)/e(F)*100}%`),m(z,`${e(Y)??""} / ${e(F)??""}`)}),o(c,E)};C(ae,c=>{e(g).length===0?c(oe):c(ie,!1)})}t(H),o(p,H),he()}ke(["click"]);export{it as component};
