import{d as xe,e as Qe,a as re,f as te}from"../chunks/P9lsyJN8.js";import{i as me}from"../chunks/9nIbbFR1.js";import{a0 as oe,h as Ie,d as Ee,am as Be,b3 as ea,l as Pe,C as aa,O as ra,b1 as ta,a_ as na,s as sa,g as ne,E as oa,b4 as ia,aB as la,e as ca,b5 as ua,b6 as da,q as va,ah as Q,aX as Ae,u as ae,Y as pe,a3 as L,a6 as N,a5 as K,ae as ue,a1 as ge,f as F,B as ee,a2 as U,b7 as fa,Q as ha,b8 as ma,a7 as pa}from"../chunks/DsCzRQW9.js";import{a as ga,s as Le,e as de,d as ya}from"../chunks/C-_o5PLK.js";import{i as Ne}from"../chunks/rK5mkmgS.js";import{p as ve,s as ba,a as wa}from"../chunks/DAvDxDB4.js";import{p as Ma}from"../chunks/BYJXd8y1.js";import{s as _a,a as ka,i as Ca,b as Ta,d as xa}from"../chunks/zUqiq0NJ.js";import{g as Fe}from"../chunks/DhYrWMOW.js";import{b as Se}from"../chunks/CAB4_IbL.js";import{o as Ia}from"../chunks/BDunwwt_.js";import{e as Ea,i as Pa}from"../chunks/BYJ2rnKm.js";import{b as Fa}from"../chunks/CkB6V6u5.js";import{b as Sa}from"../chunks/LmzTHd12.js";function Oa(t,r,u=!1,h=!1,i=!1){var f=t,g="";oe(()=>{var _=Be;if(g===(g=r()??"")){Ie&&Ee();return}if(_.nodes!==null&&(ea(_.nodes.start,_.nodes.end),_.nodes=null),g!==""){if(Ie){Pe.data;for(var y=Ee(),b=y;y!==null&&(y.nodeType!==aa||y.data!=="");)b=y,y=ra(y);if(y===null)throw ta(),na;xe(Pe,b),f=sa(y);return}var x=g+"";u?x=`<svg>${x}</svg>`:h&&(x=`<math>${x}</math>`);var k=Qe(x);if((u||h)&&(k=ne(k)),xe(ne(k),k.lastChild),u||h)for(;ne(k);)f.before(ne(k));else f.before(k)}})}const Ra=()=>performance.now(),V={tick:t=>requestAnimationFrame(t),now:()=>Ra(),tasks:new Set};function $e(){const t=V.now();V.tasks.forEach(r=>{r.c(t)||(V.tasks.delete(r),r.f())}),V.tasks.size!==0&&V.tick($e)}function Ba(t){let r;return V.tasks.size===0&&V.tick($e),{promise:new Promise(u=>{V.tasks.add(r={c:t,f:u})}),abort(){V.tasks.delete(r)}}}function fe(t,r){Ae(()=>{t.dispatchEvent(new CustomEvent(r))})}function Aa(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const r=t.split("-");return r.length===1?r[0]:r[0]+r.slice(1).map(u=>u[0].toUpperCase()+u.slice(1)).join("")}function Oe(t){const r={},u=t.split(";");for(const h of u){const[i,f]=h.split(":");if(!i||f===void 0)break;const g=Aa(i.trim());r[g]=f.trim()}return r}const La=t=>t;function se(t,r,u,h){var i=(t&ua)!==0,f="in",g,_=r.inert,y=r.style.overflow,b,x;function k(){return Ae(()=>g??=u()(r,h?.()??{},{direction:f}))}var S={is_global:i,in(){r.inert=_,b?.abort(),b=We(r,k(),x,1,()=>{fe(r,"introend"),b?.abort(),b=g=void 0,r.style.overflow=y})},out(m){{m?.(),g=void 0;return}},stop:()=>{b?.abort()}},R=Be;if((R.nodes.t??=[]).push(S),ga){var T=i;if(!T){for(var I=R.parent;I&&(I.f&oa)!==0;)for(;(I=I.parent)&&(I.f&ia)===0;);T=!I||(I.f&la)!==0}T&&ca(()=>{ae(()=>S.in())})}}function We(t,r,u,h,i){if(da(r)){var f,g=!1;return va(()=>{if(!g){var I=r({direction:"in"});f=We(t,I,u,h,i)}}),{abort:()=>{g=!0,f?.abort()},deactivate:()=>f.deactivate(),reset:()=>f.reset(),t:()=>f.t()}}if(!r?.duration&&!r?.delay)return fe(t,"introstart"),i(),{abort:Q,deactivate:Q,reset:Q,t:()=>h};const{delay:_=0,css:y,tick:b,easing:x=La}=r;var k=[];if(b&&b(0,1),y){var S=Oe(y(0,1));k.push(S,S)}var R=()=>1-h,T=t.animate(k,{duration:_,fill:"forwards"});return T.onfinish=()=>{T.cancel(),fe(t,"introstart");var I=1-h,m=h-I,$=r.duration*Math.abs(m),B=[];if($>0){var W=!1;if(y)for(var Y=Math.ceil($/16.666666666666668),G=0;G<=Y;G+=1){var w=I+m*x(G/Y),j=Oe(y(w,1-w));B.push(j),W||=j.overflow==="hidden"}W&&(t.style.overflow="hidden"),R=()=>{var Z=T.currentTime;return I+m*x(Z/$)},b&&Ba(()=>{if(T.playState!=="running")return!1;var Z=R();return b(Z,1-Z),!0})}T=t.animate(B,{duration:$,fill:"forwards"}),T.onfinish=()=>{R=()=>h,b?.(h,1-h),i()}},{abort:()=>{T&&(T.cancel(),T.effect=null,T.onfinish=Q)},deactivate:()=>{i=Q},reset:()=>{},t:()=>R()}}var ye={};(function t(r,u,h,i){var f=!!(r.Worker&&r.Blob&&r.Promise&&r.OffscreenCanvas&&r.OffscreenCanvasRenderingContext2D&&r.HTMLCanvasElement&&r.HTMLCanvasElement.prototype.transferControlToOffscreen&&r.URL&&r.URL.createObjectURL),g=typeof Path2D=="function"&&typeof DOMMatrix=="function",_=(function(){if(!r.OffscreenCanvas)return!1;try{var a=new OffscreenCanvas(1,1),e=a.getContext("2d");e.fillRect(0,0,1,1);var n=a.transferToImageBitmap();e.createPattern(n,"no-repeat")}catch{return!1}return!0})();function y(){}function b(a){var e=u.exports.Promise,n=e!==void 0?e:r.Promise;return typeof n=="function"?new n(a):(a(y,y),null)}var x=(function(a,e){return{transform:function(n){if(a)return n;if(e.has(n))return e.get(n);var o=new OffscreenCanvas(n.width,n.height),l=o.getContext("2d");return l.drawImage(n,0,0),e.set(n,o),o},clear:function(){e.clear()}}})(_,new Map),k=(function(){var a=Math.floor(16.666666666666668),e,n,o={},l=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(c){var d=Math.random();return o[d]=requestAnimationFrame(function s(v){l===v||l+a-1<v?(l=v,delete o[d],c()):o[d]=requestAnimationFrame(s)}),d},n=function(c){o[c]&&cancelAnimationFrame(o[c])}):(e=function(c){return setTimeout(c,a)},n=function(c){return clearTimeout(c)}),{frame:e,cancel:n}})(),S=(function(){var a,e,n={};function o(l){function c(d,s){l.postMessage({options:d||{},callback:s})}l.init=function(s){var v=s.transferControlToOffscreen();l.postMessage({canvas:v},[v])},l.fire=function(s,v,M){if(e)return c(s,null),e;var E=Math.random().toString(36).slice(2);return e=b(function(C){function P(O){O.data.callback===E&&(delete n[E],l.removeEventListener("message",P),e=null,x.clear(),M(),C())}l.addEventListener("message",P),c(s,E),n[E]=P.bind(null,{data:{callback:E}})}),e},l.reset=function(){l.postMessage({reset:!0});for(var s in n)n[s](),delete n[s]}}return function(){if(a)return a;if(!h&&f){var l=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{a=new Worker(URL.createObjectURL(new Blob([l])))}catch(c){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("ðŸŽŠ Could not load worker",c),null}o(a)}return a}})(),R={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function T(a,e){return e?e(a):a}function I(a){return a!=null}function m(a,e,n){return T(a&&I(a[e])?a[e]:R[e],n)}function $(a){return a<0?0:Math.floor(a)}function B(a,e){return Math.floor(Math.random()*(e-a))+a}function W(a){return parseInt(a,16)}function Y(a){return a.map(G)}function G(a){var e=String(a).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:W(e.substring(0,2)),g:W(e.substring(2,4)),b:W(e.substring(4,6))}}function w(a){var e=m(a,"origin",Object);return e.x=m(e,"x",Number),e.y=m(e,"y",Number),e}function j(a){a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight}function Z(a){var e=a.getBoundingClientRect();a.width=e.width,a.height=e.height}function be(a){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=a,e}function J(a,e,n,o,l,c,d,s,v){a.save(),a.translate(e,n),a.rotate(c),a.scale(o,l),a.arc(0,0,1,d,s,v),a.restore()}function ie(a){var e=a.angle*(Math.PI/180),n=a.spread*(Math.PI/180);return{x:a.x,y:a.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:a.startVelocity*.5+Math.random()*a.startVelocity,angle2D:-e+(.5*n-Math.random()*n),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:a.color,shape:a.shape,tick:0,totalTicks:a.ticks,decay:a.decay,drift:a.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:a.gravity*3,ovalScalar:.6,scalar:a.scalar,flat:a.flat}}function je(a,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var n=e.tick++/e.totalTicks,o=e.x+e.random*e.tiltCos,l=e.y+e.random*e.tiltSin,c=e.wobbleX+e.random*e.tiltCos,d=e.wobbleY+e.random*e.tiltSin;if(a.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-n)+")",a.beginPath(),g&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))a.fill(ze(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(c-o)*.1,Math.abs(d-l)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var s=Math.PI/10*e.wobble,v=Math.abs(c-o)*.1,M=Math.abs(d-l)*.1,E=e.shape.bitmap.width*e.scalar,C=e.shape.bitmap.height*e.scalar,P=new DOMMatrix([Math.cos(s)*v,Math.sin(s)*v,-Math.sin(s)*M,Math.cos(s)*M,e.x,e.y]);P.multiplySelf(new DOMMatrix(e.shape.matrix));var O=a.createPattern(x.transform(e.shape.bitmap),"no-repeat");O.setTransform(P),a.globalAlpha=1-n,a.fillStyle=O,a.fillRect(e.x-E/2,e.y-C/2,E,C),a.globalAlpha=1}else if(e.shape==="circle")a.ellipse?a.ellipse(e.x,e.y,Math.abs(c-o)*e.ovalScalar,Math.abs(d-l)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):J(a,e.x,e.y,Math.abs(c-o)*e.ovalScalar,Math.abs(d-l)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var p=Math.PI/2*3,A=4*e.scalar,D=8*e.scalar,z=e.x,H=e.y,X=5,q=Math.PI/X;X--;)z=e.x+Math.cos(p)*D,H=e.y+Math.sin(p)*D,a.lineTo(z,H),p+=q,z=e.x+Math.cos(p)*A,H=e.y+Math.sin(p)*A,a.lineTo(z,H),p+=q;else a.moveTo(Math.floor(e.x),Math.floor(e.y)),a.lineTo(Math.floor(e.wobbleX),Math.floor(l)),a.lineTo(Math.floor(c),Math.floor(d)),a.lineTo(Math.floor(o),Math.floor(e.wobbleY));return a.closePath(),a.fill(),e.tick<e.totalTicks}function De(a,e,n,o,l){var c=e.slice(),d=a.getContext("2d"),s,v,M=b(function(E){function C(){s=v=null,d.clearRect(0,0,o.width,o.height),x.clear(),l(),E()}function P(){h&&!(o.width===i.width&&o.height===i.height)&&(o.width=a.width=i.width,o.height=a.height=i.height),!o.width&&!o.height&&(n(a),o.width=a.width,o.height=a.height),d.clearRect(0,0,o.width,o.height),c=c.filter(function(O){return je(d,O)}),c.length?s=k.frame(P):C()}s=k.frame(P),v=C});return{addFettis:function(E){return c=c.concat(E),M},canvas:a,promise:M,reset:function(){s&&k.cancel(s),v&&v()}}}function we(a,e){var n=!a,o=!!m(e||{},"resize"),l=!1,c=m(e,"disableForReducedMotion",Boolean),d=f&&!!m(e||{},"useWorker"),s=d?S():null,v=n?j:Z,M=a&&s?!!a.__confetti_initialized:!1,E=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,C;function P(p,A,D){for(var z=m(p,"particleCount",$),H=m(p,"angle",Number),X=m(p,"spread",Number),q=m(p,"startVelocity",Number),He=m(p,"decay",Number),Ve=m(p,"gravity",Number),Ze=m(p,"drift",Number),_e=m(p,"colors",Y),Ke=m(p,"ticks",Number),ke=m(p,"shapes"),Ye=m(p,"scalar"),Ge=!!m(p,"flat"),Ce=w(p),Te=z,ce=[],Xe=a.width*Ce.x,Je=a.height*Ce.y;Te--;)ce.push(ie({x:Xe,y:Je,angle:H,spread:X,startVelocity:q,color:_e[Te%_e.length],shape:ke[B(0,ke.length)],ticks:Ke,decay:He,gravity:Ve,drift:Ze,scalar:Ye,flat:Ge}));return C?C.addFettis(ce):(C=De(a,ce,v,A,D),C.promise)}function O(p){var A=c||m(p,"disableForReducedMotion",Boolean),D=m(p,"zIndex",Number);if(A&&E)return b(function(q){q()});n&&C?a=C.canvas:n&&!a&&(a=be(D),document.body.appendChild(a)),o&&!M&&v(a);var z={width:a.width,height:a.height};s&&!M&&s.init(a),M=!0,s&&(a.__confetti_initialized=!0);function H(){if(s){var q={getBoundingClientRect:function(){if(!n)return a.getBoundingClientRect()}};v(q),s.postMessage({resize:{width:q.width,height:q.height}});return}z.width=z.height=null}function X(){C=null,o&&(l=!1,r.removeEventListener("resize",H)),n&&a&&(document.body.contains(a)&&document.body.removeChild(a),a=null,M=!1)}return o&&!l&&(l=!0,r.addEventListener("resize",H,!1)),s?s.fire(p,z,X):P(p,z,X)}return O.reset=function(){s&&s.reset(),C&&C.reset()},O}var le;function Me(){return le||(le=we(null,{useWorker:!0,resize:!0})),le}function ze(a,e,n,o,l,c,d){var s=new Path2D(a),v=new Path2D;v.addPath(s,new DOMMatrix(e));var M=new Path2D;return M.addPath(v,new DOMMatrix([Math.cos(d)*l,Math.sin(d)*l,-Math.sin(d)*c,Math.cos(d)*c,n,o])),M}function Ue(a){if(!g)throw new Error("path confetti are not supported in this browser");var e,n;typeof a=="string"?e=a:(e=a.path,n=a.matrix);var o=new Path2D(e),l=document.createElement("canvas"),c=l.getContext("2d");if(!n){for(var d=1e3,s=d,v=d,M=0,E=0,C,P,O=0;O<d;O+=2)for(var p=0;p<d;p+=2)c.isPointInPath(o,O,p,"nonzero")&&(s=Math.min(s,O),v=Math.min(v,p),M=Math.max(M,O),E=Math.max(E,p));C=M-s,P=E-v;var A=10,D=Math.min(A/C,A/P);n=[D,0,0,D,-Math.round(C/2+s)*D,-Math.round(P/2+v)*D]}return{type:"path",path:e,matrix:n}}function qe(a){var e,n=1,o="#000000",l='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof a=="string"?e=a:(e=a.text,n="scalar"in a?a.scalar:n,l="fontFamily"in a?a.fontFamily:l,o="color"in a?a.color:o);var c=10*n,d=""+c+"px "+l,s=new OffscreenCanvas(c,c),v=s.getContext("2d");v.font=d;var M=v.measureText(e),E=Math.ceil(M.actualBoundingBoxRight+M.actualBoundingBoxLeft),C=Math.ceil(M.actualBoundingBoxAscent+M.actualBoundingBoxDescent),P=2,O=M.actualBoundingBoxLeft+P,p=M.actualBoundingBoxAscent+P;E+=P+P,C+=P+P,s=new OffscreenCanvas(E,C),v=s.getContext("2d"),v.font=d,v.fillStyle=o,v.fillText(e,O,p);var A=1/n;return{type:"bitmap",bitmap:s.transferToImageBitmap(),matrix:[A,0,0,A,-E*A/2,-C*A/2]}}u.exports=function(){return Me().apply(this,arguments)},u.exports.reset=function(){Me().reset()},u.exports.create=we,u.exports.shapeFromPath=Ue,u.exports.shapeFromText=qe})((function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}})(),ye,!1);const Na=ye.exports;ye.exports.create;const $a=t=>t;function Wa(t){const r=t-1;return r*r*r+1}function Re(t){const r=typeof t=="string"&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return r?[parseFloat(r[1]),r[2]||"px"]:[t,"px"]}function he(t,{delay:r=0,duration:u=400,easing:h=$a}={}){const i=+getComputedStyle(t).opacity;return{delay:r,duration:u,easing:h,css:f=>`opacity: ${f*i}`}}function ja(t,{delay:r=0,duration:u=400,easing:h=Wa,x:i=0,y:f=0,opacity:g=0}={}){const _=getComputedStyle(t),y=+_.opacity,b=_.transform==="none"?"":_.transform,x=y*(1-g),[k,S]=Re(i),[R,T]=Re(f);return{delay:r,duration:u,easing:h,css:(I,m)=>`
			transform: ${b} translate(${(1-I)*k}${S}, ${(1-I)*R}${T});
			opacity: ${y-x*m}`}}var Da=te('<div><div class="avatar svelte-1ebqwt"> </div> <div class="bubble svelte-1ebqwt"><!></div></div>');function za(t,r){pe(r,!1);let u=ve(r,"message",8);me();var h=Da(),i=L(h),f=L(i,!0);N(i);var g=K(i,2),_=L(g);Oa(_,()=>(ue(u()),ae(()=>u().content.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n/g,"<br>")))),N(g),N(h),oe(()=>{_a(h,1,`message ${ue(u()),ae(()=>u().role)??""}`,"svelte-1ebqwt"),Le(f,(ue(u()),ae(()=>u().role==="assistant"?"ðŸ¤–":"ðŸ‘¤")))}),se(1,h,()=>ja,()=>({y:20,duration:300})),re(t,h),ge()}function Ua(t){return`Hello! I'm your English tutor. Today we are learning about **${t.replace(/-/g," ")}**. 

I can help you practice conversations, correct your grammar, or explain new words. What would you like to start with?`}function qa(t){return`You are a helpful and encouraging English language tutor for a student learning "${t}". 
    Level: Beginner/Intermediate.
    Goal: Help them practice conversation, correct mistakes gently, and explain concepts simply.
    Keep responses concise (under 50 words usually) unless explaining a complex concept.
    If the user makes a mistake, correct it politely.
    Encourage them to speak more.`}var Ha=te('<div class="message assistant loading svelte-o2sewt"><div class="avatar svelte-o2sewt">ðŸ¤–</div> <div class="bubble typing-indicator svelte-o2sewt"><span class="svelte-o2sewt">.</span><span class="svelte-o2sewt">.</span><span class="svelte-o2sewt">.</span></div></div>'),Va=te('<div class="chat-interface svelte-o2sewt"><div class="messages svelte-o2sewt"><!> <!></div> <div class="input-area svelte-o2sewt"><div class="input-wrapper svelte-o2sewt"><textarea placeholder="Type your answer here..." rows="1" class="svelte-o2sewt"></textarea> <button class="send-btn svelte-o2sewt" aria-label="Send message"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-o2sewt"><line x1="22" y1="2" x2="11" y2="13" class="svelte-o2sewt"></line><polygon points="22 2 15 22 11 13 2 9 22 2" class="svelte-o2sewt"></polygon></svg></button></div> <div class="actions svelte-o2sewt"><button class="action-btn secondary svelte-o2sewt">Finish Lesson</button></div></div></div>');function Za(t,r){pe(r,!1);let u=ve(r,"lessonId",8),h=ve(r,"onComplete",8),i=ee([]),f=ee(""),g=ee(!1),_=ee();Ia(()=>{const w=Ua(u());U(i,[{role:"assistant",content:w}])});async function y(){await ha(),F(_)&&ma(_,F(_).scrollTop=F(_).scrollHeight)}async function b(){if(!F(f).trim()||F(g))return;const w=F(f).trim();U(f,""),U(i,[...F(i),{role:"user",content:w}]),await y(),U(g,!0);try{const Z=[{role:"system",content:qa(u())},...F(i)],J=await(await fetch("http://localhost:8787/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"anglicus-tutor",messages:Z,temperature:.7})})).json();if(J.choices&&J.choices[0]){const ie=J.choices[0].message.content;U(i,[...F(i),{role:"assistant",content:ie}]),F(i).length%4===0&&(ka(10),Ca(1),Ta(2))}else U(i,[...F(i),{role:"assistant",content:"Sorry, I'm having trouble connecting right now. Let's try again."}])}catch(j){console.error(j),U(i,[...F(i),{role:"assistant",content:"Connection error. Please check if the API is running."}])}finally{U(g,!1),await y()}}function x(w){w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),b())}me();var k=Va(),S=L(k),R=L(S);Ea(R,1,()=>F(i),Pa,(w,j)=>{za(w,{get message(){return F(j)}})});var T=K(R,2);{var I=w=>{var j=Ha();se(1,j,()=>he),re(w,j)};Ne(T,w=>{F(g)&&w(I)})}N(S),Sa(S,w=>U(_,w),()=>F(_));var m=K(S,2),$=L(m),B=L($);fa(B);var W=K(B,2);N($);var Y=K($,2),G=L(Y);N(Y),N(m),N(k),oe(w=>W.disabled=w,[()=>(F(g),F(f),ae(()=>F(g)||!F(f).trim()))]),Fa(B,()=>F(f),w=>U(f,w)),de("keydown",B,x),de("click",W,b),de("click",G,function(...w){h()?.apply(this,w)}),re(t,k),ge()}var Ka=te('<div class="success-overlay svelte-4bkuey"><div class="success-card svelte-4bkuey"><div class="icon svelte-4bkuey">ðŸŽ‰</div> <h2 class="svelte-4bkuey">Lesson Completed!</h2> <p class="svelte-4bkuey">You earned <strong>50 XP</strong> and learned <strong>12 new words</strong>.</p></div></div>'),Ya=te('<div class="lesson-page svelte-4bkuey"><div class="lesson-container svelte-4bkuey"><header class="lesson-header svelte-4bkuey"><button class="back-btn svelte-4bkuey"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"></path></svg> Back</button> <h1 class="svelte-4bkuey"> </h1> <div class="progress"><div class="streak svelte-4bkuey">ðŸ”¥ Practice Mode</div></div></header> <main class="chat-wrapper svelte-4bkuey"><!></main></div> <!></div>');function ur(t,r){pe(r,!1);const u=()=>ba(Ma,"$page",h),[h,i]=wa(),f=u().params.id??"general-practice";let g=ee(!1);function _(){U(g,!0),Na({particleCount:150,spread:100,origin:{y:.6},colors:["#2dd4bf","#3b82f6","#f59e0b"]}),xa(f),setTimeout(()=>{Fe(`${Se}/`)},2500)}me();var y=Ya(),b=L(y),x=L(b),k=L(x);k.__click=()=>Fe(`${Se}/`);var S=K(k,2),R=L(S,!0);N(S),pa(2),N(x);var T=K(x,2),I=L(T);Za(I,{get lessonId(){return f},onComplete:_}),N(T),N(b);var m=K(b,2);{var $=B=>{var W=Ka();se(1,W,()=>he),re(B,W)};Ne(m,B=>{F(g)&&B($)})}N(y),oe(B=>Le(R,B),[()=>f.replace(/-/g," ")]),se(1,y,()=>he),re(t,y),ge(),i()}ya(["click"]);export{ur as component};
