import{a as r,f as C,t as h,c as M}from"../chunks/P9lsyJN8.js";import{Y as Se,Z as D,_ as H,a0 as U,a1 as Ie,a2 as k,a3 as a,a5 as s,a6 as i,f as u,a8 as q}from"../chunks/DsCzRQW9.js";import{d as Be,s as E}from"../chunks/C-_o5PLK.js";import{i as p}from"../chunks/rK5mkmgS.js";import{r as ce,s as re}from"../chunks/b05JO4El.js";import{g as De,s as J}from"../chunks/zUqiq0NJ.js";import{b as le}from"../chunks/CkB6V6u5.js";import{a as N,b as Ee,t as Me,c as Ue,d as qe}from"../chunks/B8PVRu2a.js";const Ne="AnglicusMistakes",Te=1,F="mistakes";let T=null;async function Fe(){return T||new Promise((A,w)=>{const n=indexedDB.open(Ne,Te);n.onerror=()=>w(n.error),n.onsuccess=()=>{T=n.result,A(T)},n.onupgradeneeded=y=>{const b=y.target.result;if(!b.objectStoreNames.contains(F)){const c=b.createObjectStore(F,{keyPath:"id"});c.createIndex("category","category",{unique:!1}),c.createIndex("timestamp","timestamp",{unique:!1})}}})}async function Ke(){const A=await Fe();return new Promise((w,n)=>{const c=A.transaction([F],"readwrite").objectStore(F).clear();c.onsuccess=()=>w(),c.onerror=()=>n(c.error)})}var Re=C('<section class="section svelte-1i19ct2"><h2 class="svelte-1i19ct2">Configurar API Key</h2> <p class="help svelte-1i19ct2">Tu clave se guarda encriptada en tu dispositivo</p> <div class="api-config svelte-1i19ct2"><input type="password" placeholder="sk-..." class="input svelte-1i19ct2"/> <button class="btn secondary svelte-1i19ct2">Guardar Clave</button></div> <div class="input-group svelte-1i19ct2"><div class="input-group svelte-1i19ct2"><label class="svelte-1i19ct2">Base URL (opcional - por defecto: api.openai.com) <input type="text" placeholder="https://api.openai.com" class="input svelte-1i19ct2"/></label></div></div></section>'),je=C('<div class="error-message svelte-1i19ct2"> </div>'),Oe=C('<div class="error-message svelte-1i19ct2"> </div>'),Ve=C('<section class="section svelte-1i19ct2"><h2 class="svelte-1i19ct2">Perfil</h2> <div class="profile-info svelte-1i19ct2"><p class="svelte-1i19ct2"><strong class="svelte-1i19ct2">Nombre:</strong> </p> <p class="svelte-1i19ct2"><strong class="svelte-1i19ct2">Nivel:</strong> </p> <p class="svelte-1i19ct2"><strong class="svelte-1i19ct2">Racha:</strong> </p></div></section>'),Ze=C('<div class="modal-backdrop svelte-1i19ct2"><div class="modal svelte-1i19ct2"><h3 class="svelte-1i19ct2">¬øBorrar todos los datos?</h3> <p>Esta acci√≥n no se puede deshacer. Perder√°s todo tu progreso.</p> <div class="modal-actions svelte-1i19ct2"><button class="btn secondary svelte-1i19ct2">Cancelar</button> <button class="btn danger svelte-1i19ct2">S√≠, borrar todo</button></div></div></div>'),Ge=C('<div class="settings-page svelte-1i19ct2"><header class="header svelte-1i19ct2"><h1 class="svelte-1i19ct2">Configuraci√≥n</h1></header> <section class="section svelte-1i19ct2"><h2 class="svelte-1i19ct2">Modo de API</h2> <p class="help svelte-1i19ct2">Elige c√≥mo quieres conectarte a la IA</p> <div class="api-modes svelte-1i19ct2"><button><div class="mode-icon svelte-1i19ct2">üîÑ</div> <div class="mode-info"><div class="mode-name svelte-1i19ct2">Autom√°tico</div> <div class="mode-desc svelte-1i19ct2">Prueba todas las opciones</div></div></button> <button><div class="mode-icon svelte-1i19ct2">‚òÅÔ∏è</div> <div class="mode-info"><div class="mode-name svelte-1i19ct2">Servidor</div> <div class="mode-desc svelte-1i19ct2">Usa claves del due√±o</div></div></button> <button><div class="mode-icon svelte-1i19ct2">üîë</div> <div class="mode-info"><div class="mode-name svelte-1i19ct2">Mi Clave</div> <div class="mode-desc svelte-1i19ct2">Usa tu API key</div></div></button></div></section> <!> <section class="section svelte-1i19ct2"><h2 class="svelte-1i19ct2">Probar Conexi√≥n</h2> <p class="help svelte-1i19ct2">Verifica que la API funcione</p> <div class="test-buttons svelte-1i19ct2"><div class="test-item svelte-1i19ct2"><button class="btn secondary svelte-1i19ct2"><!></button> <!></div> <div class="test-item svelte-1i19ct2"><button class="btn secondary svelte-1i19ct2"><!></button> <!></div></div></section> <section class="section danger svelte-1i19ct2"><h2 class="svelte-1i19ct2">Zona de Peligro</h2> <button class="btn danger svelte-1i19ct2">Borrar todos los datos</button></section> <!> <!></div>');function $e(A,w){Se(w,!0);let n=D(H(N())),y=De(),b=D(!1),c=H({backend:null,byok:null,puter:null}),K=D(!1),S=D(""),R=D(H(N().apiConfig.customBaseUrl||""));async function ne(){if(!u(S).trim())return;await qe(u(S).trim())?(k(S,""),k(n,N(),!0),alert("API key guardada de forma segura")):alert("Error al guardar la API key")}function j(e){Ee(e),k(n,N(),!0)}async function Q(e){k(b,!0),c[e]=null,await new Promise(t=>setTimeout(t,500)),c[e]=await Me(e),k(b,!1)}function ve(){k(K,!0)}function de(){try{localStorage.clear(),Ke().catch(console.error),window.location.assign("/onboarding")}catch{window.location.assign("/onboarding")}}var O=Ge(),V=s(a(O),2),W=s(a(V),4),Z=a(W);let X;Z.__click=()=>j("auto");var G=s(Z,2);let $;G.__click=()=>j("backend");var ee=s(G,2);let te;ee.__click=()=>j("byok"),i(W),i(V);var se=s(V,2);{var ue=e=>{var t=Re(),l=s(a(t),4),v=a(l);ce(v);var f=s(v,2);f.__click=ne,i(l);var o=s(l,2),d=a(o),m=a(d),g=s(a(m));ce(g),g.__change=()=>Ue(u(R)),i(m),i(d),i(o),i(t),le(v,()=>u(S),x=>k(S,x)),le(g,()=>u(R),x=>k(R,x)),r(e,t)};p(se,e=>{u(n).apiConfig.tier==="byok"&&e(ue)})}var L=s(se,2),ae=s(a(L),4),Y=a(ae),I=a(Y);I.__click=()=>Q("backend");var _e=a(I);{var pe=e=>{var t=h("Probando...");r(e,t)},be=e=>{var t=M(),l=q(t);{var v=o=>{var d=h("‚úÖ Funciona");r(o,d)},f=o=>{var d=M(),m=q(d);{var g=_=>{var P=h("‚ùå Fall√≥");r(_,P)},x=_=>{var P=h("Probar Servidor");r(_,P)};p(m,_=>{c.backend?.success===!1?_(g):_(x,!1)},!0)}r(o,d)};p(l,o=>{c.backend?.success===!0?o(v):o(f,!1)},!0)}r(e,t)};p(_e,e=>{u(b)?e(pe):e(be,!1)})}i(I);var fe=s(I,2);{var me=e=>{var t=je(),l=a(t,!0);i(t),U(()=>{re(t,"title",c.backend.error),E(l,c.backend.error)}),r(e,t)};p(fe,e=>{c.backend?.success===!1&&c.backend?.error&&e(me)})}i(Y);var ie=s(Y,2),B=a(ie);B.__click=()=>Q("byok");var ge=a(B);{var ke=e=>{var t=h("Probando...");r(e,t)},he=e=>{var t=M(),l=q(t);{var v=o=>{var d=h("‚úÖ Funciona");r(o,d)},f=o=>{var d=M(),m=q(d);{var g=_=>{var P=h("‚ùå Fall√≥");r(_,P)},x=_=>{var P=h("Probar Mi Clave");r(_,P)};p(m,_=>{c.byok?.success===!1?_(g):_(x,!1)},!0)}r(o,d)};p(l,o=>{c.byok?.success===!0?o(v):o(f,!1)},!0)}r(e,t)};p(ge,e=>{u(b)?e(ke):e(he,!1)})}i(B);var ye=s(B,2);{var xe=e=>{var t=Oe(),l=a(t,!0);i(t),U(()=>{re(t,"title",c.byok.error),E(l,c.byok.error)}),r(e,t)};p(ye,e=>{c.byok?.success===!1&&c.byok?.error&&e(xe)})}i(ie),i(ae),i(L);var z=s(L,2),Pe=s(a(z),2);Pe.__click=ve,i(z);var oe=s(z,2);{var Ce=e=>{var t=Ve(),l=s(a(t),2),v=a(l),f=s(a(v));i(v);var o=s(v,2),d=s(a(o));i(o);var m=s(o,2),g=s(a(m));i(m),i(l),i(t),U(()=>{E(f,` ${y.name??""}`),E(d,` ${y.level??""}`),E(g,` ${y.streakDays??""} d√≠as`)}),r(e,t)};p(oe,e=>{y&&e(Ce)})}var Ae=s(oe,2);{var we=e=>{var t=Ze(),l=a(t),v=s(a(l),4),f=a(v);f.__click=()=>k(K,!1);var o=s(f,2);o.__click=de,i(v),i(l),i(t),r(e,t)};p(Ae,e=>{u(K)&&e(we)})}i(O),U(()=>{X=J(Z,1,"mode-card svelte-1i19ct2",null,X,{selected:u(n).apiConfig.tier==="auto"}),$=J(G,1,"mode-card svelte-1i19ct2",null,$,{selected:u(n).apiConfig.tier==="backend"}),te=J(ee,1,"mode-card svelte-1i19ct2",null,te,{selected:u(n).apiConfig.tier==="byok"}),I.disabled=u(b),B.disabled=u(b)}),r(A,O),Ie()}Be(["click","change"]);export{$e as component};
