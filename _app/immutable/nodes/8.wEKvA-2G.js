import{a as l,f as d,c as F}from"../chunks/P9lsyJN8.js";import{Y as Re,Z as h,_ as fe,a1 as Pe,a3 as o,f as e,a6 as s,a5 as i,a2 as a,a8 as G,a0 as b,a9 as Qe}from"../chunks/DsCzRQW9.js";import{d as Ue,s as u}from"../chunks/C-_o5PLK.js";import{i as z}from"../chunks/rK5mkmgS.js";import{e as be,i as ze}from"../chunks/BYJ2rnKm.js";import{r as We}from"../chunks/b05JO4El.js";import{s as ye,c as De}from"../chunks/zUqiq0NJ.js";import{s as Ye}from"../chunks/CeoFgO1r.js";import{b as He}from"../chunks/CkB6V6u5.js";import{g as Je}from"../chunks/DhYrWMOW.js";import{b as Ve}from"../chunks/CAB4_IbL.js";import{g as Fe}from"../chunks/B8PVRu2a.js";var Xe=d('<div class="step svelte-15olo1z"><div class="illustration svelte-15olo1z"><svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path><path d="M12 7v10"></path></svg></div> <h1 class="svelte-15olo1z">¬°Bienvenido a Anglicus!</h1> <p class="svelte-15olo1z">Vamos a evaluar tu nivel de ingl√©s con un test r√°pido y personalizado.</p> <p class="subtitle svelte-15olo1z">El test tiene 5 preguntas y dura unos 5 minutos.</p> <button class="btn primary svelte-15olo1z">Comenzar</button></div>'),Ze=d('<div class="step svelte-15olo1z"><h2 class="svelte-15olo1z">¬øCu√°l es tu nombre?</h2> <input type="text" placeholder="Tu nombre" class="input svelte-15olo1z"/> <div class="actions svelte-15olo1z"><button class="btn primary svelte-15olo1z">Continuar</button></div></div>'),Ke=d('<button><span class="goal-emoji svelte-15olo1z"> </span> <span class="goal-label svelte-15olo1z"> </span></button>'),$e=d('<div class="step svelte-15olo1z"><h2 class="svelte-15olo1z">¬øQu√© objetivos tienes?</h2> <p class="subtitle svelte-15olo1z">Selecciona todos los que apliquen</p> <div class="goals svelte-15olo1z"></div> <div class="actions svelte-15olo1z"><button class="btn primary svelte-15olo1z">Iniciar Test</button></div></div>'),et=d('<div class="loading-state svelte-15olo1z"><div class="spinner svelte-15olo1z"></div> <p class="svelte-15olo1z">Generando test personalizado...</p></div>'),tt=d('<div class="error-state svelte-15olo1z"><p class="svelte-15olo1z"> </p> <button class="btn primary svelte-15olo1z">Reintentar</button></div>'),st=d('<div class="step results-step svelte-15olo1z"><div class="illustration success svelte-15olo1z"> </div> <h2 class="svelte-15olo1z">¬°Test completado!</h2> <p class="svelte-15olo1z">Tu nivel de ingl√©s es:</p> <div class="level-result svelte-15olo1z"><div class="level-code svelte-15olo1z"> </div> <div class="level-name svelte-15olo1z"> </div></div> <div class="score-summary svelte-15olo1z"><p class="svelte-15olo1z"> </p></div> <button class="btn primary svelte-15olo1z">Comenzar a Aprender</button></div>'),ot=d("<button> </button>"),at=d('<div class="question-card svelte-15olo1z"><div class="difficulty-badge svelte-15olo1z"> </div> <h2 class="question-text svelte-15olo1z"> </h2> <div class="options svelte-15olo1z"></div></div>'),lt=d('<div class="progress-header svelte-15olo1z"><div class="progress-bar svelte-15olo1z"><div class="progress-fill svelte-15olo1z"></div></div> <p class="question-number svelte-15olo1z"> </p></div> <!>',1),rt=d('<div class="step test-step svelte-15olo1z"><!></div>'),it=d('<div class="placement-test svelte-15olo1z"><!></div>');function zt(we,Ae){Re(Ae,!0);const ke=5;let _=h(0),R=h(""),f=h(fe([])),ae=h(!1),le=h(""),n=h(fe([])),X=fe([]),me=h(!1),v=h("A1");const xe=[{value:"travel",emoji:"‚úàÔ∏è",label:"Viajes"},{value:"work",emoji:"üíº",label:"Trabajo"},{value:"study",emoji:"üìö",label:"Estudios"},{value:"movies",emoji:"üé¨",label:"Cine y M√∫sica"},{value:"general",emoji:"üåü",label:"General"}];let g=h(1);async function he(){a(g,4),a(ae,!0),a(le,"");try{const t=`Generate ${ke} English placement test questions for Spanish speakers.
ALL QUESTIONS MUST BE IN ENGLISH ONLY.
Return ONLY a JSON object with this exact structure:
{
  "questions": [
    {
      "question": "Complete: I _____ to school every day.",
      "options": ["go", "goes", "going", "went"],
      "correctAnswer": "go",
      "difficulty": "A1"
    }
  ]
}

Include a mix of difficulties:
- 1 A1 question (basic)
- 1 A2 question (elementary)
- 1 B1 question (intermediate)
- 1 B2 question (upper intermediate)
- 1 C1 question (advanced)

Questions should test:
- Grammar (verb tenses, prepositions, articles)
- Vocabulary
- Reading comprehension

IMPORTANT: All questions and options must be in ENGLISH only. No Spanish.
Make sure the correctAnswer matches exactly one of the options.`,m=(await Fe([{role:"system",content:"You are an expert English teacher. Generate valid JSON only. Always respond in English."},{role:"user",content:t}],{maxTokens:1e3,temperature:.7})).content.match(/\{[\s\S]*\}/);if(m){const P=JSON.parse(m[0]);if(a(n,P.questions||[],!0),e(n).length===0)throw new Error("No questions generated")}else throw new Error("Invalid response format")}catch(t){console.error("Failed to generate questions, using fallback:",t),a(n,qe(),!0)}finally{a(ae,!1)}}function qe(){return[{question:"_____ is your name?",options:["What","When","Where","Who"],correctAnswer:"What",difficulty:"A1"},{question:"I _____ English every day.",options:["study","studies","studying","studied"],correctAnswer:"study",difficulty:"A1"},{question:"She _____ to Madrid yesterday.",options:["go","goes","went","going"],correctAnswer:"went",difficulty:"A2"},{question:"If I _____ rich, I would travel the world.",options:["am","was","were","be"],correctAnswer:"were",difficulty:"B1"},{question:"Despite _____ tired, he finished the work.",options:["being","to be","be","been"],correctAnswer:"being",difficulty:"B2"}]}function Se(t){X[e(_)]=t,e(_)<e(n).length-1?Qe(_):Ce()}function Ce(){const t={A1:0,A2:0,B1:0,B2:0,C1:0};let r=0;e(n).forEach((m,P)=>{X[P]===m.correctAnswer&&(t[m.difficulty]++,r++)}),t.C1>0?a(v,"C1"):t.B2>0?a(v,"B2"):t.B1>0?a(v,"B1"):t.A2>0?a(v,"A2"):a(v,"A1"),r<=1?a(v,"A1"):r===2&&e(v)!=="A1"&&a(v,"A2"),a(me,!0)}function Ie(t){e(f).includes(t)?a(f,e(f).filter(r=>r!==t),!0):a(f,[...e(f),t],!0)}function Be(){const t={name:e(R)||"Amigo",level:e(v),nativeLanguage:"es",goals:e(f).length>0?e(f):["general"],weakAreas:[],createdAt:new Date().toISOString(),lastActiveAt:new Date().toISOString(),streakDays:0,totalXP:0,wordsLearned:0,weeklyActivity:[0,0,0,0,0,0,0],achievements:[],skills:[]};De(t),Je(`${Ve}/`)}function Ee(t){return{A1:"Principiante",A2:"Elemental",B1:"Intermedio",B2:"Intermedio Alto",C1:"Avanzado",C2:"Proficiente"}[t]}function je(t){return{A1:"üå±",A2:"üåø",B1:"üå≥",B2:"üèîÔ∏è",C1:"‚≠ê",C2:"üëë"}[t]}var re=it(),Ne=o(re);{var Le=t=>{var r=Xe(),m=i(o(r),8);m.__click=()=>a(g,2),s(r),l(t,r)},Te=t=>{var r=F(),m=G(r);{var P=x=>{var q=Ze(),S=i(o(q),2);We(S),S.__keydown=c=>c.key==="Enter"&&e(R).trim()&&a(g,3);var Z=i(S,2),K=o(Z);K.__click=()=>a(g,3),s(Z),s(q),b(c=>K.disabled=c,[()=>!e(R).trim()]),He(S,()=>e(R),c=>a(R,c)),l(x,q)},Oe=x=>{var q=F(),S=G(q);{var Z=c=>{var C=$e(),Q=i(o(C),4);be(Q,21,()=>xe,ze,(U,B)=>{var y=Ke();let ee;y.__click=()=>Ie(e(B).value);var p=o(y),E=o(p,!0);s(p);var te=i(p,2),ie=o(te,!0);s(te),s(y),b(ne=>{ee=ye(y,1,"goal-card svelte-15olo1z",null,ee,ne),u(E,e(B).emoji),u(ie,e(B).label)},[()=>({selected:e(f).includes(e(B).value)})]),l(U,y)}),s(Q);var $=i(Q,2),I=o($);I.__click=he,s($),s(C),b(()=>I.disabled=e(f).length===0),l(c,C)},K=c=>{var C=F(),Q=G(C);{var $=I=>{var U=rt(),B=o(U);{var y=p=>{var E=et();l(p,E)},ee=p=>{var E=F(),te=G(E);{var ie=j=>{var N=tt(),W=o(N),ve=o(W,!0);s(W);var ce=i(W,2);ce.__click=he,s(N),b(()=>u(ve,e(le))),l(j,N)},ne=j=>{var N=F(),W=G(N);{var ve=L=>{var T=st(),w=o(T),D=o(w,!0);s(w);var Y=i(w,6),O=o(Y),de=o(O,!0);s(O);var se=i(O,2),ue=o(se,!0);s(se),s(Y);var A=i(Y,2),M=o(A),H=o(M);s(M),s(A);var _e=i(A,2);_e.__click=Be,s(T),b((k,J,oe)=>{u(D,k),u(de,e(v)),u(ue,J),u(H,`Respuestas correctas: ${oe??""} / ${e(n).length??""}`)},[()=>je(e(v)),()=>Ee(e(v)),()=>X.filter((k,J)=>k===e(n)[J]?.correctAnswer).length]),l(L,T)},ce=L=>{var T=lt(),w=G(T),D=o(w),Y=o(D);s(D);var O=i(D,2),de=o(O);s(O),s(w);var se=i(w,2);{var ue=A=>{var M=at(),H=o(M),_e=o(H,!0);s(H);var k=i(H,2),J=o(k,!0);s(k);var oe=i(k,2);be(oe,21,()=>e(n)[e(_)].options,ze,(Me,pe)=>{var V=ot();let ge;V.__click=()=>Se(e(pe));var Ge=o(V,!0);s(V),b(()=>{ge=ye(V,1,"option-btn svelte-15olo1z",null,ge,{selected:X[e(_)]===e(pe)}),u(Ge,e(pe))}),l(Me,V)}),s(oe),s(M),b(()=>{u(_e,e(n)[e(_)].difficulty),u(J,e(n)[e(_)].question)}),l(A,M)};z(se,A=>{e(n)[e(_)]&&A(ue)})}b(()=>{Ye(Y,`width: ${(e(_)+1)/e(n).length*100}%`),u(de,`Pregunta ${e(_)+1} de ${e(n).length??""}`)}),l(L,T)};z(W,L=>{e(me)?L(ve):L(ce,!1)},!0)}l(j,N)};z(te,j=>{e(le)?j(ie):j(ne,!1)},!0)}l(p,E)};z(B,p=>{e(ae)?p(y):p(ee,!1)})}s(U),l(I,U)};z(Q,I=>{e(g)===4&&I($)},!0)}l(c,C)};z(S,c=>{e(g)===3?c(Z):c(K,!1)},!0)}l(x,q)};z(m,x=>{e(g)===2?x(P):x(Oe,!1)},!0)}l(t,r)};z(Ne,t=>{e(g)===1?t(Le):t(Te,!1)})}s(re),l(we,re),Pe()}Ue(["click","keydown"]);export{zt as component};
